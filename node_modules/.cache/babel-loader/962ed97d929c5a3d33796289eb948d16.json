{"ast":null,"code":"var _jsxFileName = \"/home/diegofreitas/clone-lastfm-antigo/src/chart.js\";\nimport React from 'react';\nimport './index.css';\nimport api from './services/api';\nconst periods = [{\n  value: '7day',\n  name: 'Last 7 Days'\n}, {\n  value: '1month',\n  name: 'Last month'\n}, {\n  value: '3month',\n  name: 'Last 3 months'\n}, {\n  value: '6month',\n  name: 'Last 6 months'\n}, {\n  value: '12month',\n  name: 'Last 12 months'\n}, {\n  value: 'overall',\n  name: 'Overall'\n}];\nconst API_KEY = '87388aa0974f3cc9ddf2e4adac39a39e';\nexport default class Chart extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      selectedPeriod: periods[5],\n      charts: {\n        '7day': null,\n        '1month': null,\n        '3month': null,\n        '6month': null,\n        '12month': null,\n        'overall': null\n      },\n      isTrackChart: false\n    };\n\n    this.loadData = async () => {\n      let period = this.state.selectedPeriod.value;\n\n      if (this.state.charts[period] === null) {\n        let user = window.location.href.split('/')[3] || 'fltngboy';\n        let response = await api.get(`?api_key=${API_KEY}&method=user.gettopartists&username=${user}&limit=10&period=${period}&format=json`);\n        let charts = this.state.charts;\n        charts[period] = response.data.topartists.artist;\n        this.setState({\n          charts: charts\n        });\n      }\n    };\n\n    this.changeTab = async item => {\n      this.setState({\n        selectedPeriod: item\n      });\n    };\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.charts != this.props.charts) {\n      let isTrackChart = this.props.charts[0].duration ? true : false;\n      let charts = this.state.charts;\n      charts.overall = this.props.charts;\n      this.setState({\n        charts: charts,\n        isTrackChart: isTrackChart\n      });\n    }\n\n    if (prevState.selectedPeriod != this.state.selectedPeriod) {\n      this.loadData();\n    }\n  }\n\n  render() {\n    const period = this.state.selectedPeriod.value;\n    const topCount = this.state.charts[period] ? this.state.charts[period][0].playcount : null; //console.log(this.state);\n    //console.log(this.props);\n\n    const chartRows = this.state.charts[period] ? this.state.charts[period].map((item, index) => /*#__PURE__*/React.createElement(\"tr\", {\n      style: {\n        backgroundColor: index % 2 === 0 ? '#D8D8D8' : '#fff'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"td\", {\n      className: \"position\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 17\n      }\n    }, index + 1), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"subject\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 17\n      }\n    }, \" \", item.name), /*#__PURE__*/React.createElement(\"td\", {\n      className: \"chartBarCell\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chartBar\",\n      style: {\n        width: `${item.playcount / topCount * 100}%`\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"a\", {\n      href: \"#\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 25\n      }\n    }, item.playcount))))) : null;\n    const tabItens = periods.map(item => {\n      let comp = this.state.selectedPeriod === item ? /*#__PURE__*/React.createElement(\"li\", {\n        id: \"selected\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 85,\n          columnNumber: 13\n        }\n      }, item.name) : /*#__PURE__*/React.createElement(\"li\", {\n        onClick: () => this.changeTab(item),\n        style: {\n          cursor: 'pointer'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 13\n        }\n      }, item.name);\n      return comp;\n    });\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"artistChart\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 17\n      }\n    }, \"Top Artists\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"tabs\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 17\n      }\n    }, tabItens)), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chart\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"table\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 25\n      }\n    }, chartRows))));\n  }\n\n}","map":{"version":3,"sources":["/home/diegofreitas/clone-lastfm-antigo/src/chart.js"],"names":["React","api","periods","value","name","API_KEY","Chart","Component","state","selectedPeriod","charts","isTrackChart","loadData","period","user","window","location","href","split","response","get","data","topartists","artist","setState","changeTab","item","componentDidUpdate","prevProps","prevState","props","duration","overall","render","topCount","playcount","chartRows","map","index","backgroundColor","width","tabItens","comp","cursor"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './index.css';\nimport api from './services/api';\n\n\nconst periods = [\n    {value: '7day', name:'Last 7 Days'}, \n    {value: '1month', name:'Last month'}, \n    {value: '3month', name:'Last 3 months'}, \n    {value: '6month', name:'Last 6 months'}, \n    {value: '12month', name:'Last 12 months'}, \n    {value: 'overall', name: 'Overall'}\n]\n\nconst API_KEY = '87388aa0974f3cc9ddf2e4adac39a39e';\n\nexport default class Chart extends React.Component{\n    state = {\n        selectedPeriod: periods[5],\n        charts:{'7day': null, '1month': null, '3month': null,\n        '6month': null, '12month': null, 'overall': null},\n        isTrackChart: false\n    }\n\n\n    componentDidUpdate(prevProps, prevState){\n        if(prevProps.charts != this.props.charts){\n            let isTrackChart = this.props.charts[0].duration ? true : false\n            let charts = this.state.charts;\n            charts.overall = this.props.charts\n\n            this.setState({\n                charts: charts,\n                isTrackChart: isTrackChart\n            })\n        }\n\n        if(prevState.selectedPeriod != this.state.selectedPeriod){\n            this.loadData();\n        }\n    }\n\n    loadData = async () => {\n        let period = this.state.selectedPeriod.value;\n        if(this.state.charts[period] === null){\n            let user = window.location.href.split('/')[3] || 'fltngboy'\n            \n            let response = await api.get(`?api_key=${API_KEY}&method=user.gettopartists&username=${user}&limit=10&period=${period}&format=json`);\n        \n            let charts = this.state.charts;\n            charts[period] = response.data.topartists.artist;\n\n            this.setState({\n                charts: charts\n            })\n        }    \n    }\n\n    changeTab = async (item) => {\n        this.setState({\n            selectedPeriod: item\n        })\n    }\n\n    render(){\n        const period = this.state.selectedPeriod.value;\n        const topCount = this.state.charts[period] ? this.state.charts[period][0].playcount : null;\n        //console.log(this.state);\n        //console.log(this.props);\n        const chartRows = this.state.charts[period] ? this.state.charts[period].map((item, index) => (\n            <tr style={{backgroundColor: index%2===0 ? '#D8D8D8' : '#fff'}}>\n                <td className='position'>{index+1}</td>\n                <td className='subject'> {item.name}</td>\n                <td className='chartBarCell'>\n                    <div className='chartBar' style={{width: `${(item.playcount/topCount)*100}%`}}>\n                        <a href='#'>{item.playcount}</a>\n                    </div>\n                </td>\n            </tr>\n        )) : null\n\n\n        const tabItens = periods.map((item) => {\n            let comp = this.state.selectedPeriod === item ?\n            <li id='selected'>{item.name}</li> :\n            <li onClick={() => this.changeTab(item)} style={{cursor: 'pointer'}}>{item.name}</li>\n            return comp;\n        })\n\n        return(\n            <div className='artistChart'>\n                <h2>Top Artists</h2>\n                <div className='tabs'>\n                <ul>\n                    {tabItens}\n                </ul>\n                </div>\n                <div className='chart'>\n                    <table>\n                        <tbody>\n                            {chartRows}\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        )\n    }\n}\n"]},"metadata":{},"sourceType":"module"}