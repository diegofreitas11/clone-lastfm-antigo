{"ast":null,"code":"var url = require('url');\n\nvar defaults = require('./defaults');\n\nvar lastfm = require('lastfm');\n\nvar LastFmNode = require('lastfm').LastFmNode;\n\nvar Album = require('./album');\n\nvar Artist = require('./artist');\n\nvar Auth = require('./auth');\n\nvar Chart = require('./chart');\n\nvar Geo = require('./geo');\n\nvar Library = require('./library');\n\nvar Tag = require('./tag');\n\nvar Track = require('./track');\n\nvar User = require('./user');\n\nvar LastfmAPI = module.exports = function (options) {\n  this.api = new LastFmNode(options);\n  this.sessionCredentials = null;\n  this.album = new Album(this);\n  this.artist = new Artist(this);\n  this.auth = new Auth(this);\n  this.chart = new Chart(this);\n  this.geo = new Geo(this);\n  this.library = new Library(this);\n  this.tag = new Tag(this);\n  this.track = new Track(this);\n  this.user = new User(this);\n};\n\nLastfmAPI.prototype.getAuthenticationUrl = function (params) {\n  if (!params) params = {};\n  var baseUrl = 'http://www.last.fm/api/auth',\n      urlParts = url.parse(baseUrl);\n  urlParts.query = {};\n  ;\n  urlParts.query.api_key = this.api.api_key;\n\n  if (params.cb) {\n    urlParts.query.cb = params.cb;\n  }\n\n  if (params.token) {\n    urlParts.query.token = params.token;\n  }\n\n  return url.format(urlParts);\n};\n\nLastfmAPI.prototype.setSessionCredentials = function (username, key) {\n  this.sessionCredentials = {\n    'username': username,\n    'key': key\n  };\n};\n\nLastfmAPI.prototype.authenticate = function (token, callback) {\n  if (typeof callback !== 'function') {\n    callback = function () {};\n  }\n\n  var self = this;\n  this.auth.getSession(token, function (err, session) {\n    if (err) {\n      return callback(err);\n    }\n\n    if (!session.key) {\n      return callback(new Error('Something fishy'));\n    }\n\n    self.setSessionCredentials(session.name, session.key);\n    callback(null, self.sessionCredentials);\n  });\n};","map":{"version":3,"sources":["/home/diegofreitas/clone-lastfm-antigo/node_modules/lastfmapi/lib/lastfmapi.js"],"names":["url","require","defaults","lastfm","LastFmNode","Album","Artist","Auth","Chart","Geo","Library","Tag","Track","User","LastfmAPI","module","exports","options","api","sessionCredentials","album","artist","auth","chart","geo","library","tag","track","user","prototype","getAuthenticationUrl","params","baseUrl","urlParts","parse","query","api_key","cb","token","format","setSessionCredentials","username","key","authenticate","callback","self","getSession","err","session","Error","name"],"mappings":"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","sourcesContent":["var url = require('url');\nvar defaults = require('./defaults');\nvar lastfm = require('lastfm');\nvar LastFmNode = require('lastfm').LastFmNode;\n\nvar Album = require('./album');\nvar Artist = require('./artist');\nvar Auth = require('./auth');\nvar Chart = require('./chart');\nvar Geo = require('./geo');\nvar Library = require('./library');\nvar Tag = require('./tag');\nvar Track = require('./track');\nvar User = require('./user');\n\nvar LastfmAPI = module.exports = function (options) {\n\tthis.api = new LastFmNode(options);\n\tthis.sessionCredentials = null;\n\n\tthis.album = new Album(this);\n\tthis.artist = new Artist(this);\n\tthis.auth = new Auth(this);\n\tthis.chart = new Chart(this);\n\tthis.geo = new Geo(this);\n\tthis.library = new Library(this);\n\tthis.tag = new Tag(this);\n\tthis.track = new Track(this);\n\tthis.user = new User(this);\n};\n\nLastfmAPI.prototype.getAuthenticationUrl = function (params) {\n\tif (!params) params = {};\n\tvar baseUrl = 'http://www.last.fm/api/auth',\n\t    urlParts = url.parse(baseUrl);\n\n\turlParts.query = {};;\n\turlParts.query.api_key = this.api.api_key;\n\tif (params.cb) { urlParts.query.cb = params.cb; }\n\tif (params.token) { urlParts.query.token = params.token; }\n\n\treturn url.format(urlParts);\n};\n\nLastfmAPI.prototype.setSessionCredentials = function (username, key) {\n\tthis.sessionCredentials = {\n\t\t'username' : username,\n\t\t'key' : key\n\t};\n};\n\nLastfmAPI.prototype.authenticate = function (token, callback) {\n\tif (typeof callback !== 'function') { callback = function () {}; }\n\tvar self = this;\n\n\tthis.auth.getSession(token, function (err, session) {\n\t\tif (err) { return callback(err); }\n\t\tif (!session.key) { return callback(new Error('Something fishy')); }\n\n\t\tself.setSessionCredentials(session.name, session.key);\n\t\tcallback(null, self.sessionCredentials);\n\t});\n};\n"]},"metadata":{},"sourceType":"script"}